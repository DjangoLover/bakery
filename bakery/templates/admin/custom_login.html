{% extends "admin/login.html" %}
{% load url from future %}
{% load static from staticfiles %}

{% block extrastyle %}
<link rel="stylesheet/less" type="text/css" href="{% static 'less/bakery.less' %}" />
{% endblock %}

{% block content %}
{% url "socialauth_begin" backend="google-oauth" as login_url %}
{% if user.is_authenticated and user.is_active and not user.is_staff %}
    <p>
        You are logged in as: <br />
        {{ user.email }} <br />
        (username "{{ user.username }}"), <br />
        which is not a staff user. Please log in using another email, or ask an
        administrator to set staff status for you.
    </p>
{% endif %}

<p>
    <a class="btn btn-default color2a" id="github-login" href="{% url 'social:begin' 'github' %}"
        title="Sign in with Github">
        Login with Github!
    </a>
</p>
<p>
    <a class="btn btn-default color2a" id="persona-login"
        href="javascript:persona_login()"
        title="Sign in with Persona">
        Login with Persona!
    </a>
</p>
<!-- Define a form to send the POST data -->
<form method="post" action="/complete/persona/" id="persona-login-form">
    {% csrf_token %}
    <input type="hidden" name="assertion" id="persona-assertion" value="">
</form>

<!-- Include BrowserID JavaScript -->
<script src="https://login.persona.org/include.js" type="text/javascript"></script>

<script src="{% static 'js/vendor/less.min.js' %}"></script>

<!-- Setup click handler that retieves Persona assertion code and sends POST data -->
<!-- TODO: this does not belong here! -->
<script type="text/javascript">
  function persona_login() {
      navigator.id.get(function(assertion) {
          if (assertion) {
              var assertion_field = document.getElementById("persona-assertion");
              assertion_field.value = assertion;
              var login_form = document.getElementById("persona-login-form");
              login_form.submit();
          }
      });
  }
</script>


{% endblock %}
